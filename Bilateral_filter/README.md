# Лабораторная работа №3
### Задание
Bilateral filter

Построить 9-точечный двусторонний фильтр, применить его к изображению размера M×N и сохранить результат в виде конечного изображения.

Пропущенные значения для краевых строк и столбцов должны быть взяты из ближайших пикселей.

Реализация CUDA должна использовать текстурную память.
### Входные данные
Изображение в оттенках серого в формате BMP.

Значения σ.
### Выходные данные
Время обработки изображения с использованием графического процессора.

Время обработки изображения с использованием центрального процессора.

Результирующие изображения в формате BMP.

Язык: C++ и Python  

#### Описание программы
В программе происходит перемножение двух квадратных матриц размерности N×N, данные для заполнения которых сгенерированы случайным образом.

Пример работы:

![](example.JPG)

#### Функции:
Filling_m, где случайность данных получается за счёт использования текущего системного времени.

matMulCPU производит последовательное вычисление произведения матриц на хосте.

equals_m проверяет что результирующие матрицы вычисленные на GPU и CPU совпадают.

matMulCuda функция ядра для перемножения матриц на девайсе. 

### Результаты
Ниже приведена таблица времени работы параллельной и последовательной функций для различных размерностей матрицы. Время указано в миллисекундах и получено как среднее по 5 запускам.

Размерность матриц, N | Время работы на GPU, мс | Время работы на CPU, мс | Ускорение
:----:|:-------:|:-----------:|------:
128 | 0,15 | 8,52 | 56,80
256 | 0,63| 92,13 | 146,23
512 | 3,83 | 878,00 | 229,24
1024 | 26,06 | 16234,77 | 622,97
2048 | 190.51 | 181225,90 | 951,26

### Визуализация таблицы.
##### График времени рассчёта произведения матриц

![](Work_time.JPG)

##### График ускорения

![](Speedup.JPG)

На основе полученных результатов можно сделать вывод, что время работы функции выполняющейся на GPU растёт очень медленно при увеличении размерности матрицы, чего нельзя сказать о функции перемножения на CPU. По графику ускорения видно, что программа на CUDA дает существенный выигрыш во времени при решении задачи по переемножению матриц. 
